{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar urlAPI = 'http://localhost:5000';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nvar getData = function getData() {\n  var value;\n  return _regeneratorRuntime.async(function getData$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.getItem('accessToken'));\n\n        case 3:\n          value = _context.sent;\n\n          if (!(value !== null)) {\n            _context.next = 6;\n            break;\n          }\n\n          return _context.abrupt(\"return\", value);\n\n        case 6:\n          _context.next = 11;\n          break;\n\n        case 8:\n          _context.prev = 8;\n          _context.t0 = _context[\"catch\"](0);\n          console.log(_context.t0);\n\n        case 11:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[0, 8]], Promise);\n};\n\nexport var requestGetFriends = function requestGetFriends() {\n  var response;\n  return _regeneratorRuntime.async(function requestGetFriends$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return _regeneratorRuntime.awrap(fetch(urlAPI + \"/getFriends\"));\n\n        case 2:\n          response = _context2.sent;\n\n          if (!response.ok) {\n            _context2.next = 9;\n            break;\n          }\n\n          _context2.next = 6;\n          return _regeneratorRuntime.awrap(response.json());\n\n        case 6:\n          return _context2.abrupt(\"return\", _context2.sent);\n\n        case 9:\n          console.log(response);\n          return _context2.abrupt(\"return\", 0);\n\n        case 11:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\nexport var requestFindFriends = function requestFindFriends(emailUser) {\n  var token;\n  return _regeneratorRuntime.async(function requestFindFriends$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return _regeneratorRuntime.awrap(getData());\n\n        case 2:\n          token = _context5.sent;\n          onLoggedIn(token).then(function _callee2(chechAuth) {\n            var authResponse, res;\n            return _regeneratorRuntime.async(function _callee2$(_context4) {\n              while (1) {\n                switch (_context4.prev = _context4.next) {\n                  case 0:\n                    _context4.next = 2;\n                    return _regeneratorRuntime.awrap(chechAuth);\n\n                  case 2:\n                    authResponse = _context4.sent;\n                    _context4.next = 5;\n                    return _regeneratorRuntime.awrap(fetch(urlAPI + \"/findFriend\", {\n                      method: 'POST',\n                      headers: {\n                        'Content-Type': 'application/json;charset=utf-8',\n                        'Authorization': \"Bearer \" + token\n                      },\n                      body: JSON.stringify({\n                        email: emailUser\n                      })\n                    }).then(function _callee(res) {\n                      return _regeneratorRuntime.async(function _callee$(_context3) {\n                        while (1) {\n                          switch (_context3.prev = _context3.next) {\n                            case 0:\n                              _context3.prev = 0;\n\n                              if (!res.ok) {\n                                _context3.next = 13;\n                                break;\n                              }\n\n                              if (!authResponse) {\n                                _context3.next = 10;\n                                break;\n                              }\n\n                              console.log(res);\n                              alert(res);\n                              _context3.next = 7;\n                              return _regeneratorRuntime.awrap(res.json());\n\n                            case 7:\n                              return _context3.abrupt(\"return\", _context3.sent);\n\n                            case 10:\n                              return _context3.abrupt(\"return\", 0);\n\n                            case 11:\n                              _context3.next = 15;\n                              break;\n\n                            case 13:\n                              console.log(res);\n                              return _context3.abrupt(\"return\", 0);\n\n                            case 15:\n                              _context3.next = 20;\n                              break;\n\n                            case 17:\n                              _context3.prev = 17;\n                              _context3.t0 = _context3[\"catch\"](0);\n                              console.log(_context3.t0);\n\n                            case 20:\n                            case \"end\":\n                              return _context3.stop();\n                          }\n                        }\n                      }, null, null, [[0, 17]], Promise);\n                    }).catch(function (err) {\n                      console.log(err);\n                    }));\n\n                  case 5:\n                    res = _context4.sent;\n\n                  case 6:\n                  case \"end\":\n                    return _context4.stop();\n                }\n              }\n            }, null, null, null, Promise);\n          });\n\n        case 4:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\nexport var onLoggedIn = function onLoggedIn(token) {\n  var response;\n  return _regeneratorRuntime.async(function onLoggedIn$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.next = 2;\n          return _regeneratorRuntime.awrap(fetch(urlAPI + \"/private\", {\n            method: 'GET',\n            headers: {\n              'Content-Type': 'application/json;charset=utf-8',\n              'Authorization': \"Bearer \" + token\n            }\n          }).then(function _callee3(response) {\n            var jsonRes;\n            return _regeneratorRuntime.async(function _callee3$(_context6) {\n              while (1) {\n                switch (_context6.prev = _context6.next) {\n                  case 0:\n                    if (!response.ok) {\n                      _context6.next = 11;\n                      break;\n                    }\n\n                    _context6.prev = 1;\n                    _context6.next = 4;\n                    return _regeneratorRuntime.awrap(response.json());\n\n                  case 4:\n                    jsonRes = _context6.sent;\n                    return _context6.abrupt(\"return\", jsonRes.checkAuth);\n\n                  case 8:\n                    _context6.prev = 8;\n                    _context6.t0 = _context6[\"catch\"](1);\n                    console.log(_context6.t0);\n\n                  case 11:\n                  case \"end\":\n                    return _context6.stop();\n                }\n              }\n            }, null, null, [[1, 8]], Promise);\n          }).catch(function (err) {\n            console.log(err);\n          }));\n\n        case 2:\n          response = _context7.sent;\n\n        case 3:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};","map":{"version":3,"names":["urlAPI","AsyncStorage","getData","getItem","value","console","log","requestGetFriends","fetch","response","ok","json","requestFindFriends","emailUser","token","onLoggedIn","then","chechAuth","authResponse","method","headers","body","JSON","stringify","email","res","alert","catch","err","jsonRes","checkAuth"],"sources":["D:/проекты летом 2022/work2/barband/mobile/core/api/API.js"],"sourcesContent":["const urlAPI = 'http://localhost:5000'\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst getData = async () => {\r\n   try {\r\n      const value = await AsyncStorage.getItem('accessToken');\r\n      if(value !== null) {\r\n         return value;\r\n      }\r\n   } catch(e) {\r\n      console.log(e);\r\n   }\r\n}\r\n\r\nexport const requestGetFriends = async () => {\r\n   let response = await fetch(`${urlAPI}/getFriends`);\r\n   if (response.ok) {\r\n      return await response.json();\r\n   } else {\r\n      console.log(response);\r\n      return 0;\r\n   }\r\n}\r\n\r\nexport const requestFindFriends = async (emailUser) => {\r\n   const token = await getData();\r\n   onLoggedIn(token).then(async chechAuth => {\r\n      const authResponse = await chechAuth;\r\n      let res = await fetch(`${urlAPI}/findFriend`, {\r\n         method: 'POST',\r\n         headers: {\r\n            'Content-Type': 'application/json;charset=utf-8',\r\n            'Authorization': `Bearer ${token}`\r\n         },\r\n         body: JSON.stringify({email: emailUser})\r\n      }).then(async res => {\r\n         try{\r\n            if (res.ok) {\r\n               if(authResponse){\r\n                  console.log(res);\r\n                  alert(res);\r\n                  return await res.json();\r\n               } else {\r\n                  return 0;\r\n               }\r\n            } else {\r\n               console.log(res);\r\n               return 0;\r\n            }\r\n         } catch (err) {\r\n            console.log(err);\r\n         }\r\n      }).catch(err => {\r\n         console.log(err);\r\n      });\r\n   })\r\n\r\n  /* if (response.ok) {\r\n      console.log(response)\r\n      alert(response)\r\n      return await response.json();\r\n   } else {\r\n      console.log(response)\r\n      return 0\r\n   }*/\r\n}\r\n\r\nexport const onLoggedIn = async (token) => {\r\n   let response = await fetch(`${urlAPI}/private`, {\r\n      method: 'GET',\r\n      headers: {\r\n         'Content-Type': 'application/json;charset=utf-8',\r\n         'Authorization': `Bearer ${token}`,\r\n      },\r\n   }).then(async response => {\r\n      if (response.ok) {\r\n         try {\r\n            const jsonRes = await response.json();\r\n            return jsonRes.checkAuth\r\n         } catch (err) {\r\n            console.log(err);\r\n         }\r\n      }\r\n   }).catch(err => {\r\n      console.log(err);\r\n   });\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}